@model AddRecipeViewModel

@{
    ViewData["Title"] = "Add Recipe";
}

<h2 class="text-center">@ViewBag.Title</h2>
<hr />

<div class="row">
    <div class="col-sm-12 offset-lg-8 offset-xl-3 col-xl-6">
        <form asp-action="AddRecipe" method="post">
            <div  class="mb-3">
                <label asp-for="@Model.Name" class="form-label">Recipe name</label>
                <input id ="Name" asp-for="@Model.Name" class="form-control" aria-required="true" placeholder="Name" />
                <span asp-validation-for="@Model.Name" class="text-danger"></span>
            </div>
            <div class="mb-3">
                <label asp-for="@Model.Description" class="form-label">Description</label>
                <textarea id="Description" asp-for="@Model.Description" class="form-control" aria-required="true">Description</textarea>
                <span asp-validation-for="@Model.Description" class="text-danger"></span>
            </div>
            <div  class="mb-3">
                <label asp-for="@Model.ImageUrl" class="form-label">Image link</label>
                <input id="ImageUrl" asp-for="@Model.ImageUrl" class="form-control" aria-required="true" placeholder="https://www.mypicture.com/" />
                <span asp-validation-for="@Model.ImageUrl" class="text-danger"></span>
            </div>
            <div class="mb-3 text-danger">
                table for products from dropdown menu fetching products from db with additional field for quantities !!!
            </div>
            <div class="mb-3">
                <div class="page-content page-container" id="page-content">
                    <div class="padding">
                        <div class="row container d-flex justify-content-center">
                            <div class="col-lg-12 grid-margin stretch-card">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title text-center">Add and remove steps for recipes in table before submit </h5>
                                        <hr>
                                        <div class="table-responsive">
                                            <table id="faqs" class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th>Recipe steps</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><input type="text" placeholder="Recipe steps" class="form-control"></td>
                                                        <td class="mt-10"><button type="button" class="btn btn-danger"><i class="fa fa-trash"></i>Delete</button></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="text-center">
                                            <button type="button" onclick="addfaqs();" class="btn btn-primary"><i class="fa fa-plus"></i>Add more steps</button>
                                        </div>
                                        <div class="text-center">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="mb-3">
                <button class="btn btn-warning mb-2 w-100 p-3 fw-bold" type="button" onclick="addrecipe();">Add Recipe</button>
            </div>
        </form>
    </div>
</div>
<script>

    var faqs_row = 0;
    function addfaqs() {

        html = '<tr id="faqs-row' + faqs_row + '">';
        html += '<td><input type="text" placeholder="Recipe steps" class="form-control"></td>';
        html += '<td class="mt-10"><button type="button" class="btn btn-danger" onclick="$(\'#faqs-row' + faqs_row + '\').remove();"><i class="fa fa-trash"></i> Delete</button></td>';
        html += '</tr>';

        $('#faqs tbody').append(html);

        faqs_row++;
    }

    function addrecipe() {
        var body={};
        var string = [];
        var array = document.getElementById('faqs').getElementsByTagName("input");
        for (const iterator of array) {
            //Validations

            string.push(iterator.value);
        }
       var StepsJSON = JSON.stringify(string);
        body.Name = document.getElementById('Name').value;
        body.StepsJSON = StepsJSON;
        $.ajax({
            type: "POST",
            url: "https://localhost:7217/Recipe/AddRecipe",
            data: body,
            success: ()=>window.alert("OK SME"),
            dataType: "json/application"
        });
    }

</script>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}

